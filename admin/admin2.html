<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>后台管理中心-数字媒体实践教育基地</title>
    <link rel="shortcut icon" href="img/icon3.ico" />
    <script src="js/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/news_form.css"/>
    <script src="js/ajax.js" type="text/javascript"></script>
    <script src="js/admin2.js" type="text/javascript"></script>
</head>
<style type="text/css">

    a:visited{
        color: #666 !important;
    }
    a:hover{
        color: #fff !important;
    }
    table td,table th{
        width: 10%;
	height:30px !important;
        text-align: center;
        overflow:hidden;
    }
    table a{
        padding: 10px;
        color: #337AB7;
    }
     #upload{
	transform:translateY(-110px);
        position: absolute;
	transition:1s;
	z-index:9999;
        left:50%;
        top:0;
        margin-left: -150px;
        width:300px;
        height:100px;
        background: #333;
        border-radius: 10px;
        border:3px solid #FFF400;
        box-shadow: 1px 1px 5px 2px rgba(0,0,0,.4);
    }
    #upload #total{
        position: relative;
        width:80%;
        margin: 0 auto;
        height:20px;
        margin-top: 30px;
        background: #fff;
    }
    #loaded{
        width:0px;
        height:20px;
        background: #63cd71;
    }
    #total span{
        color: #333;
        width:100%;
        text-align: center;
        position: absolute;
        line-height:20px;
        font-size: 14px;
        top:0;
    }
    #upload p{
        color: #fff;
        line-height:40px;
        font-size: 14px;
        text-align: center;
    }
</style>
<body>
<nav class="navbar navbar-default" style="background:#333;">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../index.html" style="padding: 10px 40px;"><img src="img/TITLE1.png" height="30px"/></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav" id="nav">
                <li><a href="admin.html#getUserList">用户管理<span class="sr-only">(current)</span></a></li>
                <li><a href="admin.html#getList">留言管理</a></li>
		<li><a href="admin.html#getApply">申请信息管理</a></li>
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">新闻管理 <span class="caret"></span></a href="javascript:void(0);">
                    <ul class="dropdown-menu" id="news">
                        <li><a href="admin2.html?getNewsList#1">数字媒体行业新闻</a></li>
                        <li><a href="admin2.html?getNewsList#2">学校新闻</a></li>
                        <li><a href="admin2.html?getNewsList#3">基地新闻</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="admin2.html?getNewsList#4">比赛公告</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">成员列表管理 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="admin2.html?getStudentList">优秀学生</a></li>
                        <li><a href="admin2.html?getTeacherList">优秀指导教师</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">作品列表管理 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="admin2.html?getProductList#1">平面作品</a></li>
                        <li><a href="admin2.html?getProductList#3">影视作品</a></li>
                        <li><a href="admin2.html?getProductList#2">音频作品</a></li>
                        <li><a href="admin2.html?getProductList#4">3D与虚拟现实作品</a></li>
                    </ul>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">管理中心<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a  href="../index.html">退出</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div id="con">
    <ol class="breadcrumb" id="nav_small">
        <li><a href="index.html">首页</a></li>
        <li class="active" id="title">新闻管理</li>
        <li id="add" style="float: right;"><a  href="javascript:;">添加</a></li>
    </ol>
    <table class="table table-striped table-hover" id="List">
        <thead>

        </thead>
        <tbody>

        </tbody>
    </table>
    <nav aria-label="...">
        <ul class="pager" style="padding: 10px 20px;">
            <li class="previous" id="prev"><a href="javascript:void(0);"><span aria-hidden="true">&larr;</span>上一页</a></li>
            <li><span>一共有<strong id="alldata"></strong>条记录,当前是第<strong id="now"></strong>页,共<strong id="allpage"></strong>页.</span></li>
            <li class="next" id="next"><a href="javascript:void(0);">下一页 <span aria-hidden="true">&rarr;</span></a></li>
        </ul>
    </nav>
</div>


<div class="wrap" id="form" style="display:none;">
    <a href="javascript:;" id="close" class="closes"></a>
    <div class="news_form">
        <a href="index.html"><img src="img/TITLE1.png"/></a>
        <h3>填写内容</h3>
        <form action="/php/user/index.php?a=index&a=updateNews" method="post" class="addNews" style="display: none;">
            <p><span>新闻标题</span><input type="text" name="title" required /></p>
            <p><span>日期</span><input type="date" name="date" required /></p>
            <p>
                <span>新闻类型</span>
                <select name="type">
                    <option value ="1">数字媒体行业新闻</option>
                    <option value ="2">学校新闻</option>
                    <option value="3">基地新闻</option>
                    <option value="4">比赛公告</option>
                </select>
            </p>
            <p><span>新闻内容</span><textarea name="content" required /></textarea></p>
            <p id="tips"></p>
            <input class="submit" type="submit" value="添加新闻" >
        </form>
        <form action="/php/user/index.php?a=index&a=updateStudent" method="post" class="addTeam" style="display: none;">
            <p><span>成员姓名</span><input type="text" name="name" required /></p>
            <p><span>职称/班级</span><input type="text" name="position" required /></p>
            <p>
                <span>所在工作室</span>
                <select name="type">
                    <option value ="平面与网络工作室">平面与网络工作室</option>
                    <option value ="影视工作室">影视工作室</option>
                    <option value="音频工作室">音频工作室</option>
                    <option value="3D与虚拟现实工作室">3D与虚拟现实工作室</option>
                </select>
            </p>
            <p><span>个人简介</span><textarea name="description" required /></textarea></p>
            <p id="u_student" style="position: relative;"><span>个人照片上传</span><input type="text" name="src" required /><a style="width:70px;height:40px;position: absolute;display: inline;right: -20px;" href="javascript:;"><input style="border: 0;width: 50px;opacity: 0;position: absolute;z-index: 10;" accept="image/gif, image/jpeg,image/png" type="file"/><b style="position: absolute;top: 0;">点击上传</b></a></p>
            <p id="tips2"></p>
            <input class="submit" type="submit" value="添加成员" >
        </form>
        <form action="/php/user/index.php?a=index&a=updateTeacher" method="post" class="addTeam" style="display: none;">
            <p><span>成员姓名</span><input type="text" name="name" required /></p>
            <p><span>职称/班级</span><input type="text" name="position" required /></p>
            <p>
                <span>所在工作室</span>
                <select name="type">
                    <option value ="平面与网络工作室">平面与网络工作室</option>
                    <option value ="影视工作室">影视工作室</option>
                    <option value="音频工作室">音频工作室</option>
                    <option value="3D与虚拟现实工作室">3D与虚拟现实工作室</option>
                </select>
            </p>
            <p><span>个人简介</span><textarea name="description" required /></textarea></p>
            <p id="u_teacher" style="position: relative;"><span>个人照片上传</span><input type="text" name="src" required /><a style="width:70px;height:40px;position: absolute;display: inline;right: -20px;" href="javascript:;"><input style="border: 0;width: 50px;opacity: 0;position: absolute;z-index: 10;"  accept="image/gif, image/jpeg,image/png" type="file"/><b style="position: absolute;top: 0;">点击上传</b></a></p>
            <p id="tips3"></p>
            <input class="submit" type="submit" value="添加成员" >
        </form>
        <form action="/php/user/index.php?a=index&a=updateProduct" method="post" class="addProduct" style="">
            <p><span>作品名称</span><input type="text" name="name" required /></p>
            <p><span>作者</span><input type="text" name="author" required /></p>
            <p><span>指导教师</span><input type="text" name="teacher" required /></p>
            <p><span>获得奖项</span><input type="text" name="honor" required /></p>
            <p><span>参加赛事</span><input type="text" name="competition" required /></p>
            <p>
                <span>作品类型</span>
                <select name="type">
                    <option value ="平面作品">平面作品</option>
                    <option value ="影视作品">影视作品</option>
                    <option value="音频作品">音频作品</option>
                    <option value="3D与虚拟作品">3D与虚拟现实作品</option>
                </select>
            </p>
            <p>
                <span>所属工作室</span>
                <select name="studio">
                    <option value ="平面与网络工作室">平面与网络工作室</option>
                    <option value ="影视工作室">影视工作室</option>
                    <option value="音频工作室">音频工作室</option>
                    <option value="3D与虚拟现实工作室">3D与虚拟现实工作室</option>
                </select>
            </p>
            <p><span>作品描述</span><textarea name="description" required /></textarea></p>
            <p id="u_product" style="position: relative;"><span>作品上传</span><input  type="text" name="src" required /><a style="width:70px;height:40px;position: absolute;display: inline;right: -20px;"  href="javascript:;"><input style="border: 0;width: 50px;opacity: 0;position: absolute;z-index: 10;"  accept="image/gif, image/jpeg,audio/mp4,audio/mpeg,image/png" type="file"/><b style="position: absolute;top: 0;">点击上传</b></a></p>
            <p id="tips4"></p>
            <input class="submit" type="submit" value="添加作品" >
        </form>
    </div>
</div>

<div id="upload">
   <div id="total">
	<div id="loaded"></div>
	<span>0%</span>
   </div>
   <p>正在上传</p>
</div>


<script>
//得到
    function delProduct(id) {
        ajax('get', '/php/user/index.php', 'm=index&a=delProduct&id='+id,function (data) {
            var d = JSON.parse(data);
            if(!d.code){
                window.location.reload();
            }

        });
    }

    function delNews(id) {
        ajax('get', '/php/user/index.php', 'm=index&a=delNews&id='+id,function (data) {
            var d = JSON.parse(data);
            if(!d.code){
                window.location.reload();
            }
        });
        window.location = window.location;
    }
     function delStudent(id) {
        ajax('get', '/php/user/index.php', 'm=index&a=delStudent&id='+id,function (data) {
            var d = JSON.parse(data);
            if(!d.code){
                window.location.reload();
            }
        });
        window.location = window.location;
    }
    function delTeacher(id) {
	    ajax('get', '/php/user/index.php', 'm=index&a=delTeacher&id='+id,function (data) {
	        var d = JSON.parse(data);
	        if(!d.code){
	            window.location.reload();
	        }
	    });
	    window.location = window.location;
	}

	var form_wrap = document.getElementById('form');
   	var form = form_wrap.getElementsByTagName('form');
   	var add = document.getElementById('add');
   	var close = document.getElementById('close');
   	add.onclick = function(){
		form_wrap.style.display = 'block';
   		var key = window.location.search.split('?')[1];
   		form[0].style.display = 'none';
		form[1].style.display = 'none';
		form[2].style.display = 'none';
    		form[3].style.display = 'none';
		if(key=='getProductList'){
			form[3].style.display = 'block';
			text = form[3].getElementsByTagName('textarea')[0];
			child = form[3].getElementsByTagName('input');
			child[0].value= '';
	        	child[1].value = '';
	        	child[2].value = '';
	        	child[3].value = '';
	        	child[4].value = '';
	        	child[5].value = '';
	        	text.value = '';
		}else if(key=='getNewsList'){
			form[0].style.display = 'block';
			text = form[0].getElementsByTagName('textarea')[0];
			child = form[0].getElementsByTagName('input');
			child[0].value= '';
	        	child[1].value = '';
	        	text.value = '';
		}else if(key=='getStudentList'){
			form[1].style.display = 'block';
			text = form[1].getElementsByTagName('textarea')[0];
			child = form[1].getElementsByTagName('input');
			child[0].value= '';
	        	child[1].value = '';
	        	child[2].value = '';
	        	text.value = '';
		}else{
			form[2].style.display = 'block';
			text = form[2].getElementsByTagName('textarea')[0];
			child = form[2].getElementsByTagName('input');
			child[0].value= '';
	        	child[1].value = '';
	        	child[2].value = '';
	        	text.value = '';
		}
   	}
   	close.onclick = function(){
   		form_wrap.style.display = 'none';
   	}
   	
   
    function update(id) {
		var key = window.location.search.split('?')[1];
    	form_wrap.style.display = 'block';
    	var fn,child;
		form[0].style.display = 'none';
		form[1].style.display = 'none';
		form[2].style.display = 'none';
    	form[3].style.display = 'none';
		if(key=='getProductList'){
    		fn = 'getProduct';
    		form[3].style.display = 'block';
    		form[3].action = '/php/user/index.php?a=index&a=updateProduct&id='+id;
    		child = form[3].getElementsByTagName('input');
    	}else if(key=='getNewsList'){
    		fn = 'getNews'
    		form[0].style.display = 'block';
    		form[0].action = '/php/user/index.php?a=index&a=updateNews&id='+id;
    		child = form[0].getElementsByTagName('input');
    	}else if(key=='getStudentList'){
    		fn = 'getStudent';
    		form[1].style.display = 'block';
    		form[1].action = '/php/user/index.php?a=index&a=updateStudent&id='+id;
    		child = form[1].getElementsByTagName('input');
    	}else{
    		fn = 'getTeacher';
    		form[2].style.display = 'block';
    		form[2].action = '/php/user/index.php?a=index&a=updateTeacher&id='+id;
    		child = form[2].getElementsByTagName('input');
    	}
    	
        ajax('get', '/php/user/index.php', 'm=index&a='+fn+'&id='+id,function (data) {
		console.log(data);
        	var D = JSON.parse(data);
			var d = D.data.list[0];
	        	if(key=='getProductList'){
	        		text = form[3].getElementsByTagName('textarea')[0];
	        		child[0].value= d.name;
	        		child[1].value = d.author;
	        		child[2].value = d.teacher;
	        		child[3].value = d.honor;
	        		child[4].value = d.competition;
	        		child[5].value = d.src;
	        		text.value = d.description;
	        	}else if(key=='getNewsList'){
	        		text = form[0].getElementsByTagName('textarea')[0];
	        		child[0].value= d.title;
	        		child[1].value = d.date;
	        		text.value = d.content;
	        	}else if(key=='getStudentList'){
	        		text = form[1].getElementsByTagName('textarea')[0];
	        		child[0].value= d.name;
	        		child[1].value = d.position;
	        		child[2].value = d.src;
	        		text.value = d.description;
	        	}else{
				text = form[2].getElementsByTagName('textarea')[0];
	        		child[0].value= d.name;
	        		child[1].value = d.position;
	        		child[2].value = d.src;
	        		text.value = d.description;
			}
        });
    }


</script>
<script src="js/upload_product.js" type="text/javascript"></script>
<script src="js/upload_student.js" type="text/javascript"></script>
<script src="js/upload_teacher.js" type="text/javascript"></script>
</body>
</html>
